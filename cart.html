<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - Paw Planet</title>
    <link rel="stylesheet" href="css/paw-planet-styles.css">
    <style>
        .cart-container {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: var(--space-6);
            margin-top: var(--space-6);
        }

        .cart-item {
            display: grid;
            grid-template-columns: 100px 1fr auto;
            gap: var(--space-4);
            padding: var(--space-4);
            background: white;
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-3);
        }

        .cart-item-img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: var(--radius-md);
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            margin-top: var(--space-2);
        }

        .qty-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .qty-btn:hover {
            background: var(--gray-100);
        }

        .cart-summary {
            background: white;
            padding: var(--space-6);
            border-radius: var(--radius-lg);
            position: sticky;
            top: 120px;
            height: fit-content;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--space-3);
        }

        .progress-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--space-6);
            padding: var(--space-4);
            background: white;
            border-radius: var(--radius-lg);
        }

        .progress-step {
            flex: 1;
            text-align: center;
            position: relative;
        }

        .progress-step.active {
            color: var(--primary-teal);
            font-weight: 600;
        }
    </style>
</head>

<body>
    <div class="promo-bar">
        üéâ Free Delivery on orders above ‚Çπ599
    </div>

    <nav class="navbar">
        <div class="container">
            <div class="nav-main">
                <a href="index.html" class="nav-logo">
                    <img src="assets/images/logo.png" alt="Paw Planet">
                    <span>Paw Planet</span>
                </a>
                <div class="nav-search mobile-hidden">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" placeholder="Search...">
                </div>
                <div class="nav-actions">
                    <button class="location-selector" id="location-btn">
                        <span>üìç</span><span>Mumbai</span>
                    </button>
                    <button class="nav-icon-btn" id="account-btn">üë§</button>
                    <button class="nav-icon-btn" id="cart-btn">
                        üõí<span class="cart-badge" style="display:none;">0</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Progress Indicator -->
        <div class="progress-indicator">
            <div class="progress-step active">
                <div>üõí</div>
                <div>Cart</div>
            </div>
            <div class="progress-step">
                <div>üìç</div>
                <div>Address</div>
            </div>
            <div class="progress-step">
                <div>üìã</div>
                <div>Review</div>
            </div>
            <div class="progress-step">
                <div>üí≥</div>
                <div>Payment</div>
            </div>
        </div>

        <div class="cart-container">
            <!-- Cart Items -->
            <div>
                <h2 class="mb-4">Shopping Cart (<span id="cart-count">0</span> items)</h2>
                <div id="cart-items"></div>
                <div id="empty-cart" class="text-center p-8" style="display: none;">
                    <div class="text-4xl mb-4">üõí</div>
                    <h3 class="mb-3">Your cart is empty</h3>
                    <p class="text-muted mb-4">Add some products to get started!</p>
                    <a href="products.html" class="btn btn-primary">Shop Now</a>
                </div>
            </div>

            <!-- Cart Summary -->
            <div class="cart-summary">
                <h3 class="mb-4">Order Summary</h3>

                <div class="summary-row">
                    <span>Subtotal:</span>
                    <span id="subtotal">‚Çπ0</span>
                </div>
                <div class="summary-row text-success">
                    <span>Discount:</span>
                    <span id="discount">-‚Çπ0</span>
                </div>
                <div class="summary-row">
                    <span>Delivery:</span>
                    <span id="delivery">‚Çπ0</span>
                </div>
                <div class="summary-row">
                    <span>Tax (GST):</span>
                    <span id="tax">‚Çπ0</span>
                </div>
                <hr class="my-4">
                <div class="summary-row">
                    <span class="font-bold text-lg">Total:</span>
                    <span class="font-bold text-lg text-primary" id="total">‚Çπ0</span>
                </div>

                <div class="mt-6">
                    <div class="form-group">
                        <label class="form-label">Promo Code</label>
                        <div class="flex gap-2">
                            <input type="text" class="form-input" placeholder="Enter code" id="promo-input">
                            <button class="btn btn-outline" onclick="applyPromo()">Apply</button>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary btn-full btn-lg mt-4" onclick="proceedToCheckout()" id="checkout-btn">
                    Proceed to Checkout
                </button>

                <div class="mt-4 text-center">
                    <a href="products.html" class="text-primary">‚Üê Continue Shopping</a>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2026 Paw Planet. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="js/mock-data.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            renderCart();
        });

        function renderCart() {
            const cart = cartManager.getCart();
            const container = document.getElementById('cart-items');
            const emptyCart = document.getElementById('empty-cart');
            const checkoutBtn = document.getElementById('checkout-btn');

            document.getElementById('cart-count').textContent = cart.length;

            if (cart.length === 0) {
                container.style.display = 'none';
                emptyCart.style.display = 'block';
                checkoutBtn.disabled = true;
                return;
            }

            container.style.display = 'block';
            emptyCart.style.display = 'none';
            checkoutBtn.disabled = false;
            container.innerHTML = '';

            cart.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'cart-item';

                const price = item.variant ? item.variant.price : item.price;
                const itemTotal = price * (item.quantity || 1);

                div.innerHTML = `
          <img src="${item.image}" alt="${item.name}" class="cart-item-img">
          
          <div>
            <div class="font-semibold mb-1">${item.name}</div>
            <div class="text-sm text-muted mb-1">${item.brand || item.provider || ''}</div>
            ${item.variant ? `<div class="text-sm text-muted">Size: ${item.variant.size}</div>` : ''}
            ${item.type === 'service' ? `
              <div class="text-sm text-muted">Date: ${item.date} at ${item.time}</div>
              <div class="text-sm text-muted">Duration: ${item.duration}</div>
            ` : ''}
            
            ${item.type === 'product' ? `
              <div class="quantity-controls">
                <button class="qty-btn" onclick="updateQty(${index}, ${item.quantity - 1})">-</button>
                <span class="font-semibold">${item.quantity}</span>
                <button class="qty-btn" onclick="updateQty(${index}, ${item.quantity + 1})">+</button>
              </div>
            ` : ''}
          </div>

          <div class="text-right">
            <div class="font-bold text-lg mb-2">‚Çπ${itemTotal}</div>
            <button class="btn btn-ghost btn-sm" onclick="removeItem(${index})">üóëÔ∏è Remove</button>
          </div>
        `;

                container.appendChild(div);
            });

            updateSummary();
        }

        function updateQty(index, newQty) {
            if (newQty < 1) {
                if (confirm('Remove this item from cart?')) {
                    cartManager.removeItem(index);
                    renderCart();
                }
            } else {
                cartManager.updateQuantity(index, newQty);
                renderCart();
            }
        }

        function removeItem(index) {
            if (confirm('Remove this item from cart?')) {
                cartManager.removeItem(index);
                renderCart();
            }
        }

        function updateSummary() {
            const subtotal = cartManager.getSubtotal();
            const delivery = cartManager.getDeliveryCharges(subtotal);
            const tax = cartManager.getTax(subtotal);
            const total = subtotal + delivery + tax;

            document.getElementById('subtotal').textContent = `‚Çπ${subtotal}`;
            document.getElementById('delivery').textContent = delivery === 0 ? 'FREE' : `‚Çπ${delivery}`;
            document.getElementById('tax').textContent = `‚Çπ${tax}`;
            document.getElementById('total').textContent = `‚Çπ${total}`;
        }

        function applyPromo() {
            const code = document.getElementById('promo-input').value;
            if (code) {
                showToast('Promo code applied!', 'success');
                updateSummary();
            }
        }

        function proceedToCheckout() {
            if (!currentUser) {
                showToast('Please login to continue', 'error');
                showLoginModal();
            } else {
                window.location.href = 'checkout-address.html';
            }
        }
    </script>
</body>

</html>